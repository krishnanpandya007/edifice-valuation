{% extends "_base.html" %}

{% block content %}

<div class=" bg-gray-50 dark:bg-gray-900">

    <div class="pt-[10vh] mb-10 items-center w-full justify-center " style="padding: 40px 20px; padding-top: 5rem;">
        <!-- <li class="py-3 sm:py-4"> -->
            <div class="flex gap-4 mb-4 flex-wrap">
                <div class="px-4 py-1.5 flex items-center space-x-3 rtl:space-x-reverse border border-dashed border-gray-500  text-gray-900 text-sm rounded-lg">
                    <div class="shrink-0">
                        <svg class="stroke-black dark:stroke-white" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-loader-icon lucide-loader"><path d="M12 2v4"/><path d="m16.2 7.8 2.9-2.9"/><path d="M18 12h4"/><path d="m16.2 16.2 2.9 2.9"/><path d="M12 18v4"/><path d="m4.9 19.1 2.9-2.9"/><path d="M2 12h4"/><path d="m4.9 4.9 2.9 2.9"/></svg>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-semibold text-gray-900 truncate dark:text-white">
                            Report Status
                        </p>
                        <p class="text-sm text-gray-500 truncate dark:text-gray-400 text-lower">
                            {{ report_status }}
                        </p>
                    </div>
                    
                </div>
                <a href="{% url 'edit_assignees' site_id %}" class="px-4 py-1.5 flex items-center space-x-3 rtl:space-x-reverse border border-dashed border-gray-500 border-gray-300 text-gray-900 text-sm rounded-lg">
                    <div class="shrink-0">
                        <svg class="stroke-black dark:stroke-white"  xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users-icon lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-semibold text-gray-900 truncate dark:text-white">
                            Assignees
                        </p>
                        <p class="text-sm text-gray-500 truncate dark:text-gray-400">
                            Click to edit
                        </p>
                    </div>
                    
                </a>
            </div>
        <!-- </li> -->
        <div class="md:hidden mb-5">
            <label for="tabs" class="dark:text-white">Select Section</label>
            <select id="tabs"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                {% for section_name, section_detail in context.items %}
                    <option value="{{ section_name }}-tab">{{ section_detail.display_name }}</option>
                {% endfor %}
            </select>

        </div>

        <div class="flex h-400">

            <ul class="hidden md:flex md:flex-col space-ytext-sm font-medium text-gray-500 dark:text-gray-400 md:me-4 mb-4 md:mb-0 h-400"
                id="default-tab" data-tabs-toggle="#default-tab-content" role="tablist">
                {% for section_name, section_detail in context.items %}

                    <li class="border-b border-gray-200 dark:border-gray-600">
                        <a href="#" id="{{ section_name }}-tab" data-tabs-target="#{{ section_name }}" type="button"
                            role="tab" aria-controls="{{ section_name }}" aria-selected="false"
                            class="inline-flex items-center px-4 py-3 rounded-md hover:text-gray-900 bg-gray-50 hover:bg-gray-100 w-full dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-white">
                            {{ section_detail.display_name }}
                        </a>
                    </li>

                {% endfor %}
                
                <!-- <li class="border-b border-gray-200 dark:border-gray-600">
                    <a href="#" id="application-details-tab" data-tabs-target="#application-details" type="button"
                        role="tab" aria-controls="application-details" aria-selected="false"
                        class="inline-flex items-center px-4 py-3 rounded-md hover:text-gray-900 bg-gray-50 hover:bg-gray-100 w-full dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-white">
                        Application Details
                    </a>
                </li> -->
                
            </ul>


            <div
                class="px-6 bg-gray-50 text-medium text-gray-500 dark:text-gray-400 dark:bg-gray-800 rounded-lg w-full">
                <div id="default-tab-content">
                    {% for section_name, section_detail in context.items %}
                    <div class="hidden pt-4 rounded-lg bg-gray-50 dark:bg-gray-800" id="{{ section_name }}"
                    role="tabpanel" aria-labelledby="{{ section_name }}-tab">
                        <div class="w-full flex flex-wrap border-b border-gray-200 dark:border-gray-700 pb-4"
                            style="justify-content: space-between;width: 100%;align-items: center;">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-white"
                                style="align-items: center;">{{ section_detail.display_name }}</h2>
                            <div class="inline-flex rounded-md shadow-xs" role="group">
                                <button type="button"
                                    class="p-3 mr-1 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-full hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-blue-500 dark:focus:text-white">
                                    <svg width="15" height="15" viewBox="0 0 15 15" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M6.85355 3.14645C7.04882 3.34171 7.04882 3.65829 6.85355 3.85355L3.70711 7H12.5C12.7761 7 13 7.22386 13 7.5C13 7.77614 12.7761 8 12.5 8H3.70711L6.85355 11.1464C7.04882 11.3417 7.04882 11.6583 6.85355 11.8536C6.65829 12.0488 6.34171 12.0488 6.14645 11.8536L2.14645 7.85355C1.95118 7.65829 1.95118 7.34171 2.14645 7.14645L6.14645 3.14645C6.34171 2.95118 6.65829 2.95118 6.85355 3.14645Z"
                                            fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path>
                                    </svg>
                                </button>

                                <button onclick="loadSection('documents-tab')" type="button"
                                    class="p-3 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-full hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-blue-500 dark:focus:text-white">
                                    <svg width="15" height="15" viewBox="0 0 15 15" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z"
                                            fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path>
                                    </svg> </button>
                            </div>
                        </div>
                        <div class="  lg:py-4">
                            <form method="post" action="{% url 'view_site' site_id %}" enctype="multipart/form-data" style="margin-top: 5px;" >
                                {% csrf_token %}
                                <input type="text" name="section-name" value="{{ section_name }}" hidden>
                                <div class="mb-8">
                                    
                                    {% for field in section_detail.fields %}
                                        <div  >
                                            <label for="{{ field.name }}" class="block mb-1 text-sm font-medium text-gray-900 dark:text-white" >{{ field.label }}</label>
                                            {% if 'edit' == field.access_level %}
                                                {% if field.field_type == "textbox" %}
                                                    <input type="text" value="{{ field.value }}" name="{{ field.name }}" id="{{ field.name }}"  class="bg-gray-50 mb-5 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"  />
                                                {% elif field.field_type == "radio" %}
                                                    <ul class="w-48 mb-5 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                                        {% for choice in field.choices %}
                                                            <li class="w-full border-b border-gray-200 rounded-t-lg dark:border-gray-600 pl-5">
                                                                <div class="flex items-center ps-3">
                                                                    {% if field.value == choice.0 %}
                                                                    <input checked id="{{ field.name }}-{{ forloop.counter }}" type="radio" value="{{ choice | first }}" name="{{ field.name }}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
                                                                    {% else %}
                                                                    <input  id="{{ field.name }}-{{ forloop.counter }}" type="radio" value="{{ choice | first }}" name="{{ field.name }}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">

                                                                    {% endif %}
                                                                    <label for="{{ field.name }}-{{ forloop.counter }}" class="w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">{{ choice | first }} </label>
                                                                </div>
                                                            </li>
                                                            
                                                            {% endfor %}
                                                        
                                                    </ul>    
                                                
                                                {% elif field.field_type == "dropdown" %}
                                                    <select id="countries" class="bg-gray-50 mb-5 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                                                        {% if not field.value %}
                                                            <option disabled selected value>-- Select an option --</option>
                                                        {% endif %}
                                                        {% for choice in field.choices %}
                                                            
                                                            {% if field.value == choice.0 %}

                                                            <option value="{{ choice | first }}" selected>{{ choice | first }}</option>
                                                            {% else %}
                                                            <option value="{{ choice | first }}">{{ choice | first }}</option>

                                                            {%endif%}
                                                        {% endfor %}
                                                    </select>
                                                {% elif field.field_type == "date" %}
                                                    <div class="relative mb-6">
                                                        <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                                        <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                                            <path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
                                                        </svg>
                                                        </div>
                                                        <input value="{{ field.value|date:'m-d-Y' }}" datepicker id="{{ field.name }}" name="{{ field.name }}" type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Select date" >
                                                    </div>
                                                {% elif field.field_type == "textbox-percentage" %}
                                                    <input value="{{ field.value }}" min="0" max="100" type="number" id="{{ section_name }}-{{ field.name }}" aria-describedby="helper-text-explanation" class="mb-5 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" style="width: 10ch;" />
                                                {% elif field.field_type == "multiselect-checkbox" %}
                                                    <ul name="{{ field.name }}" class="mb-5 w-48 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                                        {% for choice in field.choices %}
                                                            {% if choice.0 in field.value %}
                                                            <li class="w-full border-b border-gray-200 rounded-t-lg dark:border-gray-600 pl-5">
                                                                <div class="flex items-center ps-3">
                                                                    <input checked id="{{ field.name }}-{{ forloop.counter }}" name="{{ field.name }}" type="checkbox" value="{{ choice | first }}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
                                                                    <label for="{{ field.name }}-{{ forloop.counter }}" class="w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">{{ choice | first }}</label>
                                                                </div>
                                                            </li>
                                                            {% else %}
                                                            <li class="w-full border-b border-gray-200 rounded-t-lg dark:border-gray-600 pl-5">
                                                                <div class="flex items-center ps-3">
                                                                    <input id="{{ field.name }}-{{ forloop.counter }}" name="{{ field.name }}" type="checkbox" value="{{ choice | first }}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
                                                                    <label for="{{ field.name }}-{{ forloop.counter }}" class="w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">{{ choice | first }}</label>
                                                                </div>
                                                            </li>

                                                            {% endif %}
                                                        {% endfor %}
                                                    </ul>
                                                {% elif field.field_type == "file-upload" or field.field_type == "image-upload" %}
                                                    
                                                    <div class="inline-flex rounded-md shadow-xs mb-5 mt-1">
                                                        {% if field.field_type == "file-upload" %}
                                                            <input onchange="handleFileUpload(this)" hidden type="file" name="{{ field.name }}" id="{{ field.name }}">
                                                        {% else %}
                                                            <input onchange="handleFileUpload(this)" hidden type="file" accept="image/*" name="{{ field.name }}" id="{{ field.name }}">
                                                        {% endif %}
                                                        <input type="text" name="__include__@{{ field.name }}" value="constant" hidden id="__include__@{{ field.name }}">
                                                        {% if field.value %}
                                                            <button type="button" id="{{ field.name }}-remove" onclick="removeAttachment('{{ field.name }}')" class="dark:hover:text-white dark:hover:bg-gray-700 hover:bg-gray-100 hover:text-blue-700 px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-l-lg focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:focus:ring-blue-500 dark:focus:text-white" >
                                                                <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8536 2.85355C13.0488 2.65829 13.0488 2.34171 12.8536 2.14645C12.6583 1.95118 12.3417 1.95118 12.1464 2.14645L7.5 6.79289L2.85355 2.14645C2.65829 1.95118 2.34171 1.95118 2.14645 2.14645C1.95118 2.34171 1.95118 2.65829 2.14645 2.85355L6.79289 7.5L2.14645 12.1464C1.95118 12.3417 1.95118 12.6583 2.14645 12.8536C2.34171 13.0488 2.65829 13.0488 2.85355 12.8536L7.5 8.20711L12.1464 12.8536C12.3417 13.0488 12.6583 13.0488 12.8536 12.8536C13.0488 12.6583 13.0488 12.3417 12.8536 12.1464L8.20711 7.5L12.8536 2.85355Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>                                                        
                                                            </button>
                                                            <div id="{{ field.name }}-display"  aria-current="page" class="px-4 py-2 text-sm font-medium text-blue-700 bg-white border border-gray-200 rounded-s-lg focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white  dark:focus:ring-blue-500 dark:focus:text-white" style="border-left: none; border-radius: 0;">
                                                                {{ field.filename }}
                                                            </div>
                                                            <a href="{{ field.value.path }}" target="_blank" rel="noopener noreferrer" id="{{ field.name }}-view" class="dark:hover:text-white dark:hover:bg-gray-700 hover:bg-gray-100 hover:text-blue-700 px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-e-lg focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:focus:ring-blue-500 dark:focus:text-white" style="border-left: none; border-radius: 0;">
                                                                <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 11C4.80285 11 2.52952 9.62184 1.09622 7.50001C2.52952 5.37816 4.80285 4 7.5 4C10.1971 4 12.4705 5.37816 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11ZM7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C1.65639 10.2936 4.30786 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C13.3436 4.70638 10.6921 3 7.5 3ZM7.5 9.5C8.60457 9.5 9.5 8.60457 9.5 7.5C9.5 6.39543 8.60457 5.5 7.5 5.5C6.39543 5.5 5.5 6.39543 5.5 7.5C5.5 8.60457 6.39543 9.5 7.5 9.5Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                                                            </a>
                                                        {% else %}
                                                            <div id="{{ field.name }}-display" class="px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-l-lg focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:focus:ring-blue-500 dark:focus:text-white" >
                                                                <i>No attachment</i>
                                                                <!-- <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8536 2.85355C13.0488 2.65829 13.0488 2.34171 12.8536 2.14645C12.6583 1.95118 12.3417 1.95118 12.1464 2.14645L7.5 6.79289L2.85355 2.14645C2.65829 1.95118 2.34171 1.95118 2.14645 2.14645C1.95118 2.34171 1.95118 2.65829 2.14645 2.85355L6.79289 7.5L2.14645 12.1464C1.95118 12.3417 1.95118 12.6583 2.14645 12.8536C2.34171 13.0488 2.65829 13.0488 2.85355 12.8536L7.5 8.20711L12.1464 12.8536C12.3417 13.0488 12.6583 13.0488 12.8536 12.8536C13.0488 12.6583 13.0488 12.3417 12.8536 12.1464L8.20711 7.5L12.8536 2.85355Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>                                                         -->
                                                            </div>
                                                        {% endif %}
                                                        <button type="button" onclick="handleFileButtonClick('{{ field.name }}')" class="dark:hover:text-white dark:hover:bg-gray-700 hover:bg-gray-100 hover:text-blue-700 px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-e-lg focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:focus:ring-blue-500 dark:focus:text-white" style="border-left: none;">
                                                            <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 5.00006C3.22386 5.00006 3 5.22392 3 5.50006L3 11.5001C3 11.7762 3.22386 12.0001 3.5 12.0001L11.5 12.0001C11.7761 12.0001 12 11.7762 12 11.5001L12 5.50006C12 5.22392 11.7761 5.00006 11.5 5.00006L10.25 5.00006C9.97386 5.00006 9.75 4.7762 9.75 4.50006C9.75 4.22392 9.97386 4.00006 10.25 4.00006L11.5 4.00006C12.3284 4.00006 13 4.67163 13 5.50006L13 11.5001C13 12.3285 12.3284 13.0001 11.5 13.0001L3.5 13.0001C2.67157 13.0001 2 12.3285 2 11.5001L2 5.50006C2 4.67163 2.67157 4.00006 3.5 4.00006L4.75 4.00006C5.02614 4.00006 5.25 4.22392 5.25 4.50006C5.25 4.7762 5.02614 5.00006 4.75 5.00006L3.5 5.00006ZM7 1.6364L5.5682 3.0682C5.39246 3.24393 5.10754 3.24393 4.9318 3.0682C4.75607 2.89246 4.75607 2.60754 4.9318 2.4318L7.1818 0.181802C7.26619 0.09741 7.38065 0.049999 7.5 0.049999C7.61935 0.049999 7.73381 0.09741 7.8182 0.181802L10.0682 2.4318C10.2439 2.60754 10.2439 2.89246 10.0682 3.0682C9.89246 3.24393 9.60754 3.24393 9.4318 3.0682L8 1.6364L8 8.5C8 8.77614 7.77614 9 7.5 9C7.22386 9 7 8.77614 7 8.5L7 1.6364Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>                                                        </button>

                                                    </div>
                                                {% elif field.field_type == "textbox-number" %}
                                                <input type="number" value="{{ field.value }}" name="{{ field.name }}" id="{{ field.name }}"  class="bg-gray-50 mb-5 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"  />
                                                {% elif field.field_type == "multiple-image-upload" %} 
                                                <input type="text" name="{{ field.name }}-remove-list" hidden id="{{ field.name }}-remove-list"> 
                                                <input type="text" name="{{ field.name }}" hidden value="true"> 
                                                <div id="upload-file-list-{{ field.name}}"></div>
                                                <div class="flex flex-wrap" id="{{ field.name }}-container" style="height: 200px;">
                                                    <div onclick="handleModalOpen('{{ field.name }}')" data-modal-target="add-image-{{ field.name }}" data-modal-toggle="add-image-{{ field.name }}" style="width: min-content; min-width: 150px;display: flex;align-items: center;justify-content: center;flex-direction: column;text-align: center;gap: 1rem;" class="p-2 cursor-pointer max-w-sm bg-white border border-dashed mr-2 mb-2  border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">
                                                        <svg width="25" height="25" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.49991 0.876892C3.84222 0.876892 0.877075 3.84204 0.877075 7.49972C0.877075 11.1574 3.84222 14.1226 7.49991 14.1226C11.1576 14.1226 14.1227 11.1574 14.1227 7.49972C14.1227 3.84204 11.1576 0.876892 7.49991 0.876892ZM1.82707 7.49972C1.82707 4.36671 4.36689 1.82689 7.49991 1.82689C10.6329 1.82689 13.1727 4.36671 13.1727 7.49972C13.1727 10.6327 10.6329 13.1726 7.49991 13.1726C4.36689 13.1726 1.82707 10.6327 1.82707 7.49972ZM7.50003 4C7.77617 4 8.00003 4.22386 8.00003 4.5V7H10.5C10.7762 7 11 7.22386 11 7.5C11 7.77614 10.7762 8 10.5 8H8.00003V10.5C8.00003 10.7761 7.77617 11 7.50003 11C7.22389 11 7.00003 10.7761 7.00003 10.5V8H4.50003C4.22389 8 4.00003 7.77614 4.00003 7.5C4.00003 7.22386 4.22389 7 4.50003 7H7.00003V4.5C7.00003 4.22386 7.22389 4 7.50003 4Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                                                        Add new
                                                    </div>
                                                    <div id="add-image-{{ field.name }}" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                                                        <div class="relative p-4 max-w-md w-full  max-h-full">
                                                            <!-- Modal content -->
                                                            <div class="relative bg-white rounded-lg shadow-sm dark:bg-gray-700">
                                                                <!-- Modal header -->
                                                                <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200">
                                                                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                                                                        Add new image
                                                                    </h3>
                                                                    <button onclick="closeModal('{{ field.name }}')" id="add-image-modal-close-button" type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="add-image-{{ field.name }}">
                                                                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                                                        </svg>
                                                                        <span class="sr-only">Close modal</span>
                                                                    </button>
                                                                </div>
                                                                <!-- Modal body -->
                                                                <div id="{{ fieldName }}-add-image-modal-body" class="p-4 md:p-5">
                                                                    <label for="image_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Image Name</label>
                                                                    <input type="text" id="image_name" class="mb-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Name" />

                                                                    <!-- <label for="image_upload" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Upload</label> -->
                                                                    <label id="image-upload-modal-label" for="image_upload" style="display: flex;flex-direction: column;align-items: center;justify-content: center;gap:0.5rem;height: 8rem;" class="mb-2 bg-gray-50 border border-dashed border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Name" >
                                                                        <svg width="20" height="20" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.81825 1.18188C7.64251 1.00615 7.35759 1.00615 7.18185 1.18188L4.18185 4.18188C4.00611 4.35762 4.00611 4.64254 4.18185 4.81828C4.35759 4.99401 4.64251 4.99401 4.81825 4.81828L7.05005 2.58648V9.49996C7.05005 9.74849 7.25152 9.94996 7.50005 9.94996C7.74858 9.94996 7.95005 9.74849 7.95005 9.49996V2.58648L10.1819 4.81828C10.3576 4.99401 10.6425 4.99401 10.8182 4.81828C10.994 4.64254 10.994 4.35762 10.8182 4.18188L7.81825 1.18188ZM2.5 9.99997C2.77614 9.99997 3 10.2238 3 10.5V12C3 12.5538 3.44565 13 3.99635 13H11.0012C11.5529 13 12 12.5528 12 12V10.5C12 10.2238 12.2239 9.99997 12.5 9.99997C12.7761 9.99997 13 10.2238 13 10.5V12C13 13.104 12.1062 14 11.0012 14H3.99635C2.89019 14 2 13.103 2 12V10.5C2 10.2238 2.22386 9.99997 2.5 9.99997Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                                                                        Click to upload
                                                                    </label>
                                                                    <!-- <input onchange="showModalUploadedImage(this)" hidden type="file" accept="image/*"  id="image_upload" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white hidden"> -->
                                                                     <div id="image-upload-modal-preview">

                                                                     </div>

                                                                    <button data-modal-hide="add-image-{{ field.name }}" type="button" onclick="handleAddImage(this)" data-field-name="{{ field.name }}" class="cursor-pointer text-white inline-flex w-full justify-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                                                                        Add Image
                                                                    </button>
                                                                    <button onclick="clearImageModal()" type="button" class="mt-2 w-full focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900">Clear</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div> 
                                                    <!-- <div style="width: min-content; min-width: 150px;" class="max-w-sm bg-white border mr-2 mb-2  border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">
                                                        <a href="#">
                                                            <img class="rounded-t-lg"  src="https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?q=80&w=2075&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="" />
                                                        </a>
                                                        <div class="p-2">
                                                            <p class="text-xs font-bold text-gray-900 dark:text-white mb-2">FRONT VIEW</p>
                                                            <div class="flex justify-start">

                                                                <button onclick="deleteImageFromPool(this)" data-field-name="{{ field.name }}" data-attachment-id="2" type="button" class=" justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 me-2 ">
                                                                    <svg role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="binIconTitle" stroke="red" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="binIconTitle">Bin</title> <path d="M19 6L5 6M14 5L10 5M6 10L6 20C6 20.6666667 6.33333333 21 7 21 7.66666667 21 11 21 17 21 17.6666667 21 18 20.6666667 18 20 18 19.3333333 18 16 18 10"/> </svg>
                                                                </button>
                                                                <button type="button" class="justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 ">
                                                                    <svg class="stroke-black dark:stroke-white" role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="maximiseIconTitle" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="maximiseIconTitle">Maximise View</title> <polyline points="21 16 21 21 16 21"/> <polyline points="8 21 3 21 3 16"/> <polyline points="16 3 21 3 21 8"/> <polyline points="3 8 3 3 8 3"/> </svg>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div> -->
                                                    {% for image in field.all %}
                                                        <div style="width: min-content; min-width: 150px;" class="max-w-sm bg-white border mr-2 mb-2  border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">
                                                            <a href="#">
                                                                <img class="rounded-t-lg"  src="{{ image.attachment.url }}" alt="" />
                                                            </a>
                                                            <div class="p-2">
                                                                <p class="text-xs font-bold text-gray-900 dark:text-white mb-2">{{ image.name }}</p>
                                                                <div class="flex justify-start">

                                                                    <button onclick="deleteImageFromPool(this)" data-field-name="{{ field.name }}" data-attachment-id="{{ image.id }}" type="button" class=" justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 me-2 ">
                                                                        <svg role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="binIconTitle" stroke="red" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="binIconTitle">Bin</title> <path d="M19 6L5 6M14 5L10 5M6 10L6 20C6 20.6666667 6.33333333 21 7 21 7.66666667 21 11 21 17 21 17.6666667 21 18 20.6666667 18 20 18 19.3333333 18 16 18 10"/> </svg>
                                                                    </button>
                                                                    <button type="button" class="justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 ">
                                                                        <a href="{{ image.attachment.url }}">
                                                                            <svg class="stroke-black dark:stroke-white" role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="maximiseIconTitle" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="maximiseIconTitle">Maximise View</title> <polyline points="21 16 21 21 16 21"/> <polyline points="8 21 3 21 3 16"/> <polyline points="16 3 21 3 21 8"/> <polyline points="3 8 3 3 8 3"/> </svg>

                                                                        </a>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    {% endfor %}
                                                    <!-- <div style="width: min-content; min-width: 150px;" class=" max-w-sm bg-white border mr-2 mb-2  border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">
                                                        <a href="#">
                                                            <img class="rounded-t-lg"  src="https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?q=80&w=2075&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="" />
                                                        </a>
                                                        <div class="p-2">
                                                            <p class="text-xs font-bold text-gray-900 dark:text-white mb-2">REAR VIEW</p>
                                                            <div class="flex justify-start">

                                                                <button onclick="deleteImageFromPool(this)" data-field-name="{{ field.name }}" data-attachment-id="null" type="button" class=" justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 me-2 ">
                                                                    <svg role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="binIconTitle" stroke="red" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="binIconTitle">Bin</title> <path d="M19 6L5 6M14 5L10 5M6 10L6 20C6 20.6666667 6.33333333 21 7 21 7.66666667 21 11 21 17 21 17.6666667 21 18 20.6666667 18 20 18 19.3333333 18 16 18 10"/> </svg>
                                                                </button>
                                                                <a href="https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?q=80&w=2075&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" type="button" class="justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 ">
                                                                    <svg class="stroke-black dark:stroke-white" role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="maximiseIconTitle" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="maximiseIconTitle">Maximise View</title> <polyline points="21 16 21 21 16 21"/> <polyline points="8 21 3 21 3 16"/> <polyline points="16 3 21 3 21 8"/> <polyline points="3 8 3 3 8 3"/> </svg>
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div> -->
                                                {% endif %}
                                            {% elif 'view' == field.access_level %}
                                                {% if field.field_type == "file-upload" %}
                                                    <span class="flex mb-5" style="align-items: center;">
                                                        <!-- <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 1.5C11 1.22386 10.7761 1 10.5 1C10.2239 1 10 1.22386 10 1.5V4H5V1.5C5 1.22386 4.77614 1 4.5 1C4.22386 1 4 1.22386 4 1.5V4H1.5C1.22386 4 1 4.22386 1 4.5C1 4.77614 1.22386 5 1.5 5H4V10H1.5C1.22386 10 1 10.2239 1 10.5C1 10.7761 1.22386 11 1.5 11H4V13.5C4 13.7761 4.22386 14 4.5 14C4.77614 14 5 13.7761 5 13.5V11H10V13.5C10 13.7761 10.2239 14 10.5 14C10.7761 14 11 13.7761 11 13.5V11H13.5C13.7761 11 14 10.7761 14 10.5C14 10.2239 13.7761 10 13.5 10H11V5H13.5C13.7761 5 14 4.77614 14 4.5C14 4.22386 13.7761 4 13.5 4H11V1.5ZM10 10V5H5V10H10Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg> -->
                                                        <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 11L6 4L10.5 7.5L6 11Z" fill="currentColor"></path></svg>
                                                        {% if field.value %}
                                                            <a href="{{ field.value.url }}">Click to open</a>
                                                        {% else %}
                                                            <i>No Attachment</i>
                                                        {% endif %}
                                                    </span>
                                                {% elif field.field_type == "image-upload" %}
                                                    <span class="flex mb-5" style="align-items: center;">
                                                        <!-- <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 1.5C11 1.22386 10.7761 1 10.5 1C10.2239 1 10 1.22386 10 1.5V4H5V1.5C5 1.22386 4.77614 1 4.5 1C4.22386 1 4 1.22386 4 1.5V4H1.5C1.22386 4 1 4.22386 1 4.5C1 4.77614 1.22386 5 1.5 5H4V10H1.5C1.22386 10 1 10.2239 1 10.5C1 10.7761 1.22386 11 1.5 11H4V13.5C4 13.7761 4.22386 14 4.5 14C4.77614 14 5 13.7761 5 13.5V11H10V13.5C10 13.7761 10.2239 14 10.5 14C10.7761 14 11 13.7761 11 13.5V11H13.5C13.7761 11 14 10.7761 14 10.5C14 10.2239 13.7761 10 13.5 10H11V5H13.5C13.7761 5 14 4.77614 14 4.5C14 4.22386 13.7761 4 13.5 4H11V1.5ZM10 10V5H5V10H10Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg> -->
                                                        <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 11L6 4L10.5 7.5L6 11Z" fill="currentColor"></path></svg>
                                                        {% if field.value %}
                                                            <a href="{{ field.value.url }}">
                                                                <img class="rounded-md" style="height: 100px;" src="{{ field.value.url }}" />
                                                            </a>
                                                        {% else %}
                                                            <i>No Attachment</i>
                                                        {% endif %}
                                                    </span>
                                                {% elif field.field_type == "multiple-image-upload" %}
                                                    <span class="flex mb-5" style="align-items: center;">
                                                        <!-- <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 1.5C11 1.22386 10.7761 1 10.5 1C10.2239 1 10 1.22386 10 1.5V4H5V1.5C5 1.22386 4.77614 1 4.5 1C4.22386 1 4 1.22386 4 1.5V4H1.5C1.22386 4 1 4.22386 1 4.5C1 4.77614 1.22386 5 1.5 5H4V10H1.5C1.22386 10 1 10.2239 1 10.5C1 10.7761 1.22386 11 1.5 11H4V13.5C4 13.7761 4.22386 14 4.5 14C4.77614 14 5 13.7761 5 13.5V11H10V13.5C10 13.7761 10.2239 14 10.5 14C10.7761 14 11 13.7761 11 13.5V11H13.5C13.7761 11 14 10.7761 14 10.5C14 10.2239 13.7761 10 13.5 10H11V5H13.5C13.7761 5 14 4.77614 14 4.5C14 4.22386 13.7761 4 13.5 4H11V1.5ZM10 10V5H5V10H10Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg> -->
                                                        <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 11L6 4L10.5 7.5L6 11Z" fill="currentColor"></path></svg>
                                                        {% for image in field.all %}
                                                            <a class="mb-2 mr-2" href="{{ image.url }}">
                                                                <img class="rounded-md" style="height: 100px;" src="{{ image.url }}" />
                                                                <b class="text-xs">{{ image.name }}</b>
                                                            </a>
                                                        {% endfor %}
                                                    </span>
                                                {% else %}
                                                    <span class="flex mb-5" style="align-items: center;">
                                                        <!-- <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 1.5C11 1.22386 10.7761 1 10.5 1C10.2239 1 10 1.22386 10 1.5V4H5V1.5C5 1.22386 4.77614 1 4.5 1C4.22386 1 4 1.22386 4 1.5V4H1.5C1.22386 4 1 4.22386 1 4.5C1 4.77614 1.22386 5 1.5 5H4V10H1.5C1.22386 10 1 10.2239 1 10.5C1 10.7761 1.22386 11 1.5 11H4V13.5C4 13.7761 4.22386 14 4.5 14C4.77614 14 5 13.7761 5 13.5V11H10V13.5C10 13.7761 10.2239 14 10.5 14C10.7761 14 11 13.7761 11 13.5V11H13.5C13.7761 11 14 10.7761 14 10.5C14 10.2239 13.7761 10 13.5 10H11V5H13.5C13.7761 5 14 4.77614 14 4.5C14 4.22386 13.7761 4 13.5 4H11V1.5ZM10 10V5H5V10H10Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg> -->
                                                        <svg class="mr-1" width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 11L6 4L10.5 7.5L6 11Z" fill="currentColor"></path></svg>
                                                        <span>{{ field.value }}</span>
                                                    </span>
                                                {% endif %}
                                            {% endif %}
                                        </div>
                                    {% endfor %}
                                </div>
                                <div style="display: flex;gap: 1rem">
                                    
                                    <button type="submit" class=" mb-2 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Save</button>
                                    {% if user.role in next_report_statuses.access_roles %}
                                        {% for next_status in next_report_statuses.next %}
                                            <form action="{% url 'change_status' site.id %}" method="post">
                                                <input hidden type="text" name="next_status" value="{{ next_status }}">
                                                <button class="relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-purple-600 to-blue-500 group-hover:from-purple-600 group-hover:to-blue-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800">
                                                    <span class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-transparent group-hover:dark:bg-transparent">
                                                        Mark as {{ next_status }}
                                                    </span>
                                                </button>
                                            </form>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </form>
                        </div>
                    </div>
                    {% endfor %}
                    
                    <!-- <div class="hidden pt-4 rounded-lg bg-gray-50 dark:bg-gray-800" id="application-details"
                        role="tabpanel" aria-labelledby="application-details-tab">
                        <div class="w-full flex flex-wrap border-b border-gray-200 dark:border-gray-700 pb-4"
                            style="justify-content: space-between;width: 100%;align-items: center;">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-white"
                                style="align-items: center;">Application details</h2>
                            <div class="inline-flex rounded-md shadow-xs" role="group">
                                <button type="button"
                                    class="p-3 mr-1 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-full hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-blue-500 dark:focus:text-white">
                                    <svg width="15" height="15" viewBox="0 0 15 15" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M6.85355 3.14645C7.04882 3.34171 7.04882 3.65829 6.85355 3.85355L3.70711 7H12.5C12.7761 7 13 7.22386 13 7.5C13 7.77614 12.7761 8 12.5 8H3.70711L6.85355 11.1464C7.04882 11.3417 7.04882 11.6583 6.85355 11.8536C6.65829 12.0488 6.34171 12.0488 6.14645 11.8536L2.14645 7.85355C1.95118 7.65829 1.95118 7.34171 2.14645 7.14645L6.14645 3.14645C6.34171 2.95118 6.65829 2.95118 6.85355 3.14645Z"
                                            fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path>
                                    </svg>
                                </button>

                                <button onclick="loadSection('documents-tab')" type="button"
                                    class="p-3 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-full hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-blue-500 dark:focus:text-white">
                                    <svg width="15" height="15" viewBox="0 0 15 15" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z"
                                            fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path>
                                    </svg> </button>
                            </div>
                        </div>
                        <div class=" max-w-2xl lg:py-4">
                            
                        </div>
                    </div> -->
                    

                </div>
            </div>
        </div>


    </div>
</div>

<script>

    var tabs = document.querySelectorAll('a[role="tab"]');

    document.getElementById("tabs").addEventListener("change", (e) => {

        tabs.forEach((tab, idx) => {
            if (tab.id === e.target.value) {
                tab.click()
            }
        })

    })

    function loadSection(section_name) {

        tabs.forEach((tab, idx) => {

            if (tab.id === section_name) {
                tab.click();
            }

        })

    }

    function handleFileButtonClick(fieldName){

        // let display_elem =  document.getElementById(`${fieldName}-display`)
        let input_elem =  document.getElementById(`${fieldName}`)

        input_elem.click()

    }

    function handleFileUpload(e) {

        let display_elem =  document.getElementById(`${e.id}-display`)

        let uploaded_file = e.files[0]

        if (uploaded_file){
            // console.log(uplo)
            display_elem.innerText = uploaded_file.name;
        }

        let handler_input = document.getElementById(`__include__@${e.id}`)

        handler_input.value = "add"

    }
    function removeAttachment(field_name) {

        let handler = document.getElementById(`__include__@${field_name}`);

        handler.value = "remove"

        let remove_btn = document.getElementById(`${field_name}-remove`)
        let view_btn = document.getElementById(`${field_name}-view`)
        let display_elem = document.getElementById(`${field_name}-display`)

        remove_btn.style.display = "none";
        view_btn.style.display = "none";
        display_elem.innerHTML = "<i>No attachment</i>"

    }
    function deleteImageFromPool(e){
        const parentContainer = e.parentElement.parentElement.parentElement;
        const fieldName = e.getAttribute("data-field-name")
        const attachmentId = e.getAttribute("data-attachment-id")

        parentContainer.style.display = "none";

        if (attachmentId != "null"){
            
            let removeListElem = document.getElementById(`${fieldName}-remove-list`)
            let removeList = removeListElem.value

            if(removeList){

                removeList = removeList.split(",")
            } else {
                removeList = []
            }

            removeList.push(attachmentId)

            removeListElem.value = removeList.toString()


        }

    }
    let uploadFileCounter = 0;
    let g = null
    function handleAddImage(e){
        const nameElem = document.getElementById("image_name")
        
        const fieldName = e.getAttribute("data-field-name")
        const fileElem = document.getElementById(`${fieldName}@file@${uploadFileCounter}`)
        const container = document.getElementById(`${fieldName}-container`)
        const display_container = document.getElementById("image-upload-modal-preview")

        const reader = new FileReader()
        const fileRef = fileElem.files[0]
        const file = new File([fileRef], fileRef.name, {type: fileRef.type, lastModified: fileRef.lastModified})
        console.log(document.getElementById(`${fieldName}@file@${uploadFileCounter}`).files)

        if (file) {
            reader.readAsDataURL(file);
        }
        console.log(document.getElementById(`${fieldName}@file@${uploadFileCounter}`).files)
        document.getElementById("add-image-modal-close-button").click()
        const fileName = nameElem.value ? nameElem.value : `Untitled-${uploadFileCounter}`
        
        reader.addEventListener("load", function () {
            // let file_input = document.createElement("input")
            // file_input.type = "file"
            // file_input.name = `${fieldName}@file@${uploadFileCounter}`
            // file_input.style.display = "none"
            
            // let new_child = document.createElement("div")
            // new_child.style = "width: min-content; min-width: 150px;"
            // new_child.className="max-w-sm bg-white border mr-2 mb-2  border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700"
            // container.appendChild(document.getElementById(`${fieldName}@file@${uploadFileCounter}`))
            // const dataTransfer = new DataTransfer();
            // dataTransfer.items.add(file);
            // console.log(dataTransfer.files)
            // const fileList = dataTransfer.files;
            // file_input.files = fileList;
            // console.log(file_input.files)

            // file_input.dispatchEvent(new Event('change', { bubbles: true }))
            // file_input.dispatchEvent(new Event('input', { bubbles: true }));
            console.log(document.getElementById(`${fieldName}@file@${uploadFileCounter-1}`).files)

            container.innerHTML += `
                                <div id="${fieldName}-container-item-${uploadFileCounter-1}" style="width: min-content; min-width: 150px;" class="max-w-sm bg-white border mr-2 mb-2  border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">
                                    <input type="text" name="${fieldName}@name@${uploadFileCounter-1}" value="${fileName}" hidden />
                                    <a href="#">
                                        <img class="rounded-t-lg"  src="${reader.result}" alt="" />
                                    </a>
                                    <div class="p-2">
                                        <p class="text-xs font-bold text-gray-900 dark:text-white mb-2">${fileName}</p>
                                        <div class="flex justify-start">

                                            <button onclick="deleteImageFromPool(this)" data-field-name="${fieldName}" data-attachment-id="null" type="button" class=" justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 me-2 ">
                                                <svg role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="binIconTitle" stroke="red" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="binIconTitle">Bin</title> <path d="M19 6L5 6M14 5L10 5M6 10L6 20C6 20.6666667 6.33333333 21 7 21 7.66666667 21 11 21 17 21 17.6666667 21 18 20.6666667 18 20 18 19.3333333 18 16 18 10"/> </svg>
                                            </button>
                                            <button type="button" class="justify-center text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-100 font-medium rounded-lg text-sm  p-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-white dark:hover:bg-gray-700 ">
                                                <svg class="stroke-black dark:stroke-white" role="img" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24" aria-labelledby="maximiseIconTitle" stroke-width="3" stroke-linecap="square" stroke-linejoin="miter" fill="none" color="#2329D6"> <title id="maximiseIconTitle">Maximise View</title> <polyline points="21 16 21 21 16 21"/> <polyline points="8 21 3 21 3 16"/> <polyline points="16 3 21 3 21 8"/> <polyline points="3 8 3 3 8 3"/> </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>                   
            `
            // container.appendChild(new_child)
            // console.log(fileElem.files[0])
            
            // container.innerHTML +=
            console.log("logging:")
            console.log(document.getElementById(`${fieldName}@file@${uploadFileCounter-1}`).files)
             
            g = fileElem
        })
        uploadFileCounter++;
        // document.getElementById("add-image-modal-close-button").click()
        const modal = document.getElementById(`add-image-${fieldName}`);
        if (modal) {
            modal.classList.add("hidden");
            modal.setAttribute("aria-hidden", "true");

            // Ensure focus is removed from any button inside before hiding
            setTimeout(() => document.activeElement?.blur(), 0);
        }

        // e.blur()
    }
document.querySelectorAll("[data-modal-hide]").forEach(button => {
    button.addEventListener("click", (event) => {
        const modalId = event.target.closest("button").getAttribute("data-modal-hide").replace("add-image-", "");
        handleModalClose(modalId);
    });
});
    function showModalUploadedImage(e){
        const display_container = document.getElementById("image-upload-modal-preview")
        const name_container = document.getElementById("image_name")

        const file = e.files[0]
        name_container.value = file.name;
        const reader = new FileReader()
        if (file) {
            reader.readAsDataURL(file);
        }
        document.getElementById("image-upload-modal-label").style.display = "none"
        reader.addEventListener("load", function () {
            display_container.innerHTML = `
            <img height="100" src="${reader.result}" class="rounded-md mb-2" />
            `
        })
    }

    function clearImageModal() {
        const display_container = document.getElementById("image-upload-modal-preview")
        const name_container = document.getElementById("image_name")

        display_container.innerHTML = ``
        name_container.value = ""
        document.getElementById("image-upload-modal-label").style.display = "flex"

    }
    function closeModal(fieldName) {

        const modal = document.getElementById(`add-image-${fieldName}`);
        if (modal) {
            modal.classList.add("hidden");
            modal.setAttribute("aria-hidden", "true");

            // Ensure focus is removed from any button inside before hiding
            setTimeout(() => document.activeElement?.blur(), 0);
        }

    }

    function handleModalOpen(fieldName) {
        const modal = document.getElementById(`add-image-${fieldName}`);
        if (modal) {
            modal.classList.remove("hidden");
            modal.setAttribute("aria-hidden", "false");
            modal.classList.add("flex");
            setTimeout(() => modal.querySelector("input")?.focus(), 50);
            // modal.querySelector("input")?.focus(); // Shift focus inside the modal
            let image_file = document.getElementById(`${fieldName}@file@${uploadFileCounter}`)
            
        if(image_file == null){
            // image_file = 
            image_file = document.createElement("input")
            image_file.type = "file"
            image_file.name = `${fieldName}@file@${uploadFileCounter}`
            image_file.id = `${fieldName}@file@${uploadFileCounter}`
            image_file.style.display = "none"
            image_file.addEventListener("change", (e) => {
                showModalUploadedImage(image_file);
            });

        }
        // if(image_file.files){

        //     console.log(image_file.files[0])
        // }else {
        //     console.log("Lauda lele")
        // }

        document.getElementById(`upload-file-list-${fieldName}`).appendChild(image_file)


        document.getElementById("image-upload-modal-label").setAttribute("for", `${fieldName}@file@${uploadFileCounter}`)
        
    }

    }

</script>


{% endblock %}